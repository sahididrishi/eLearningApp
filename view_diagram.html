<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eLearning Architecture Diagram</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <h1>eLearning Platform Architecture</h1>
    <div class="mermaid">
graph TD
    Client[Browser / Client]
    
    subgraph "ASGI Server (Daphne)"
        Router[ProtocolTypeRouter]
        
        subgraph "HTTP Handling"
            DjangoApp[Django ASGI App]
            Views[Views / API]
        end
        
        subgraph "WebSocket Handling"
            Auth[AuthMiddlewareStack]
            URLRouter[URLRouter]
            Consumer[ChatConsumer]
        end
    end
    
    subgraph "Data Store"
        DB[(PostgreSQL/SQLite)]
        Redis[(Redis)]
    end
    
    Client -- "HTTP / HTTPS" --> Router
    Client -- "WS / WSS" --> Router
    
    Router -- "protocol: http" --> DjangoApp
    DjangoApp --> Views
    Views -- Query --> DB
    
    Router -- "protocol: websocket" --> Auth
    Auth --> URLRouter
    URLRouter --> Consumer
    
    Consumer -- "Channel Layer" --> Redis
    Redis -.-> Consumer
    </div>
</body>
</html>
